---
title: "Comparing Linear MEM with Segmented Regressions"
author: "Indra Boving & Joe Celebrezze"
date: "7/20/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Setup
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

#lots of extra here, but oh well... 
library(ggplot2)
library(gapminder)
library(data.table)
library(purrr) #for visualizing all variables in one big plot
library(naniar) #for dealing with NAs nicely 
library(tidyverse)
library(devtools)
library(ggfortify)
library(ggpubr)
library(jtools)
library(cowplot)
library(lmerTest)
library(ggeffects)  # install the package first if you haven't already, then load it
library(GGally) #for corr plots
require(kimisc) # has the nlist function to create a named list
require(AICcmodavg) # has the aictab function
library(psych)
#devtools::install_github("strengejacke/strengejacke")
library(strengejacke)
library(sjPlot) # table functions
library(sjmisc) # sample data
library(lme4) # fitting models
library(here)
library(effects) #for plotting model effects
library(sjstats) #use for r2 functions
library(TMB)
library(glmmTMB)
library(lattice)
library(equatiomatic)
library("broom.mixed")
library(ggbiplot)
select = dplyr::select
here = here::here
library(MuMIn)
library(modelsummary)
#install_github("BlakeRMills/MetBrewer") 
#library("BlakeRMills/MetBrewer")
#library(memmented)
filter = dplyr::filter
mutate = dplyr::mutate
library(nlme)
library(MetBrewer)
#install.packages("memmented")
#devtools::install_github("hohenstein/remef")
library(remef)
library(kableExtra)
```

# 1. Data wrangling
Reading in dataframe
```{r}
scaled.mem.data.alldates.noNAs <- read.csv(here('processed-data', 'mem.data.subset.alldates'))
```

Species split
```{r}
mem.data.ceme <- scaled.mem.data.alldates.noNAs %>% 
  filter(spp == "CEME")

mem.data.adfa <- scaled.mem.data.alldates.noNAs %>% 
  filter(spp == "ADFA")
```

# 2. PC1: Model Comparison

## ADFA

### Mixed Effects Models
```{r}
m1 <- lme(PC1~ mpa + year.month + site, random=~1|id, data=mem.data.adfa)

m2 <- lme(PC1~ lfm + year.month + site, random=~1|id, data=mem.data.adfa)

m3 <- lme(PC1~ ww.flam.sample + year.month + site, random=~1|id, data=mem.data.adfa)

m4 <- lme(PC1~ dw.flam.sample + year.month + site, random=~1|id, data=mem.data.adfa)

m5 <- lme(PC1~ mpa + dw.flam.sample + sample.wt + year.month + site, random=~1|id, data=mem.data.adfa)
```

Table
```{r}
tab_model(m1, m2, m3, m4, m5,
          show.reflvl = FALSE, 
          digits = 3, 
          show.aic = TRUE, 
          show.ci = FALSE,
          show.icc = FALSE, 
          pred.labels = c(),
         dv.labels = c("Model 1", "Model 2", "Model 3", "Model 4", "Model 5"),
         string.pred = "Coeffcient", 
         title = "models with no collinearity",
  string.p = "P-Value", 
  p.style = "stars",
  file = here('MEM.figures','ADFA.PC1.MEM.html')) # saving .html into figures folder
```

### Segmented Regressions
```{r}
s.m1<-lme(PC1~ mpa + year.month + site, random=~1|id, data=mem.data.adfa)
os.m1<-segmented.default(s.m1, ~mpa, npsi=list(mpa=1))
summary.segmented(os.m1)
#AIC: 997.4369

s.m2<-lme(PC1~ lfm + year.month + site, random=~1|id, data=mem.data.adfa)
os.m2<-segmented.default(s.m2, ~lfm, npsi=list(lfm=1))
summary.segmented(os.m2)
#AIC: 1015.843

s.m3<-lme(PC1~ ww.flam.sample + year.month + site, random=~1|id, data=mem.data.adfa)
os.m3<-segmented.default(s.m3, ~ww.flam.sample, npsi=list(ww.flam.sample=1))
summary.segmented(os.m3)
#AIC: 1009.496

s.m4<-lme(PC1~ dw.flam.sample + year.month + site, random=~1|id, data=mem.data.adfa)
os.m4<-segmented.default(s.m4, ~dw.flam.sample, npsi=list(dw.flam.sample=1))
summary.segmented(os.m4)
#AIC: 1013.969
```

## CEME

### Mixed Effects Models
```{r}
m1 <- lme(PC1~ mpa + year.month + site, random=~1|id, data=mem.data.ceme)

m2 <- lme(PC1~ lfm + year.month + site, random=~1|id, data=mem.data.ceme)

m3 <- lme(PC1~ ww.flam.sample + year.month + site, random=~1|id, data=mem.data.ceme)

m4 <- lme(PC1~ dw.flam.sample + year.month + site, random=~1|id, data=mem.data.ceme)

m5 <- lme(PC1~ mpa + dw.flam.sample + sample.wt + year.month + site, random=~1|id, data=mem.data.ceme)
```

Table
```{r}
tab_model(m1, m2, m3, m4, m5,
          show.reflvl = FALSE, 
          digits = 3, 
          show.aic = TRUE, 
          show.ci = FALSE,
          show.icc = FALSE, 
          pred.labels = c(),
         dv.labels = c("Model 1", "Model 2", "Model 3", "Model 4", "Model 5"),
         string.pred = "Coeffcient", 
         title = "models with no collinearity",
  string.p = "P-Value", 
  p.style = "stars",
  file = here('MEM.figures','CEME.PC1.MEM.html')) # saving .html into figures folder
```

### Segmented Regressions
```{r}
s.m1<-lme(PC1~ mpa + year.month + site, random=~1|id, data=mem.data.ceme)
os.m1<-segmented.default(s.m1, ~mpa, npsi=list(mpa=1))
summary.segmented(os.m1)
#AIC: 677.2741

s.m2<-lme(PC1~ lfm + year.month + site, random=~1|id, data=mem.data.ceme)
os.m2<-segmented.default(s.m2, ~lfm, npsi=list(lfm=1))
summary.segmented(os.m2)
#AIC: 677.3073

s.m3<-lme(PC1~ ww.flam.sample + year.month + site, random=~1|id, data=mem.data.ceme)
os.m3<-segmented.default(s.m3, ~ww.flam.sample, npsi=list(ww.flam.sample=1))
summary.segmented(os.m3)
#AIC: 677.6505

s.m4<-lme(PC1~ dw.flam.sample + year.month + site, random=~1|id, data=mem.data.ceme)
os.m4<-segmented.default(s.m4, ~dw.flam.sample, npsi=list(dw.flam.sample=1))
summary.segmented(os.m4)
#AIC: 681.1898
```

# 3. TTI: Model Comparison
## ADFA

### Mixed Effects Models
```{r}
m1 <- lme(tti~ mpa + year.month + site, random=~1|id, data=mem.data.adfa)

m2 <- lme(tti~ lfm + year.month + site, random=~1|id, data=mem.data.adfa)

m3 <- lme(tti~ ww.flam.sample + year.month + site, random=~1|id, data=mem.data.adfa)

m4 <- lme(tti~ dw.flam.sample + year.month + site, random=~1|id, data=mem.data.adfa)

m5 <- lme(tti~ mpa + dw.flam.sample + sample.wt + year.month + site, random=~1|id, data=mem.data.adfa)
```

Table
```{r}
tab_model(m1, m2, m3, m4, m5,
          show.reflvl = FALSE, 
          digits = 3, 
          show.aic = TRUE, 
          show.ci = FALSE,
          show.icc = FALSE, 
          pred.labels = c(),
         dv.labels = c("Model 1", "Model 2", "Model 3", "Model 4", "Model 5"),
         string.pred = "Coeffcient", 
         title = "models with no collinearity",
  string.p = "P-Value", 
  p.style = "stars",
  file = here('MEM.figures','ADFA.tti.MEM.html')) # saving .html into figures folder
```

### Segmented Regressions
```{r}
s.m1<-lme(tti~ mpa + year.month + site, random=~1|id, data=mem.data.adfa)
os.m1<-segmented.default(s.m1, ~mpa, npsi=list(mpa=1))
summary.segmented(os.m1)
#AIC: 1937.612

s.m2<-lme(tti~ lfm + year.month + site, random=~1|id, data=mem.data.adfa)
os.m2<-segmented.default(s.m2, ~lfm, npsi=list(lfm=1))
summary.segmented(os.m2)
#AIC: 1967.475

s.m3<-lme(tti~ ww.flam.sample + year.month + site, random=~1|id, data=mem.data.adfa)
os.m3<-segmented.default(s.m3, ~ww.flam.sample, npsi=list(ww.flam.sample=1))
summary.segmented(os.m3)
#AIC: 1961.825

s.m4<-lme(tti~ dw.flam.sample + year.month + site, random=~1|id, data=mem.data.adfa)
os.m4<-segmented.default(s.m4, ~dw.flam.sample, npsi=list(dw.flam.sample=1))
summary.segmented(os.m4)
#AIC: 1980.427
```

## CEME

### Mixed Effects Models
```{r}
m1 <- lme(tti~ mpa + year.month + site, random=~1|id, data=mem.data.ceme)

m2 <- lme(tti~ lfm + year.month + site, random=~1|id, data=mem.data.ceme)

m3 <- lme(tti~ ww.flam.sample + year.month + site, random=~1|id, data=mem.data.ceme)

m4 <- lme(tti~ dw.flam.sample + year.month + site, random=~1|id, data=mem.data.ceme)

m5 <- lme(tti~ mpa + dw.flam.sample + sample.wt + year.month + site, random=~1|id, data=mem.data.ceme)
```

Table
```{r}
tab_model(m1, m2, m3, m4, m5,
          show.reflvl = FALSE, 
          digits = 3, 
          show.aic = TRUE, 
          show.ci = FALSE,
          show.icc = FALSE, 
          pred.labels = c(),
         dv.labels = c("Model 1", "Model 2", "Model 3", "Model 4", "Model 5"),
         string.pred = "Coeffcient", 
         title = "models with no collinearity",
  string.p = "P-Value", 
  p.style = "stars",
  file = here('MEM.figures','CEME.tti.MEM.html')) # saving .html into figures folder
```

### Segmented Regressions
```{r}
s.m1<-lme(tti~ mpa + year.month + site, random=~1|id, data=mem.data.ceme)
os.m1<-segmented.default(s.m1, ~mpa, npsi=list(mpa=1))
summary.segmented(os.m1)
#AIC: 1381.347

s.m2<-lme(tti~ lfm + year.month + site, random=~1|id, data=mem.data.ceme)
os.m2<-segmented.default(s.m2, ~lfm, npsi=list(lfm=1))
summary.segmented(os.m2)
#AIC: 1392.99

s.m3<-lme(tti~ ww.flam.sample + year.month + site, random=~1|id, data=mem.data.ceme)
os.m3<-segmented.default(s.m3, ~ww.flam.sample, npsi=list(ww.flam.sample=1))
summary.segmented(os.m3)
#AIC: 1389.266

s.m4<-lme(tti~ dw.flam.sample + year.month + site, random=~1|id, data=mem.data.ceme)
os.m4<-segmented.default(s.m4, ~dw.flam.sample, npsi=list(dw.flam.sample=1))
summary.segmented(os.m4)
#AIC: 1406.177
```

# 4. FH: Model Comparison

## ADFA

### Mixed Effects Models
```{r}
m1 <- lme(fh~ mpa + year.month + site, random=~1|id, data=mem.data.adfa)

m2 <- lme(fh~ lfm + year.month + site, random=~1|id, data=mem.data.adfa)

m3 <- lme(fh~ ww.flam.sample + year.month + site, random=~1|id, data=mem.data.adfa)

m4 <- lme(fh~ dw.flam.sample + year.month + site, random=~1|id, data=mem.data.adfa)

m5 <- lme(fh~ mpa + dw.flam.sample + sample.wt + year.month + site, random=~1|id, data=mem.data.adfa)
```

Table
```{r}
tab_model(m1, m2, m3, m4, m5,
          show.reflvl = FALSE, 
          digits = 3, 
          show.aic = TRUE, 
          show.ci = FALSE,
          show.icc = FALSE, 
          pred.labels = c(),
         dv.labels = c("Model 1", "Model 2", "Model 3", "Model 4", "Model 5"),
         string.pred = "Coeffcient", 
         title = "models with no collinearity",
  string.p = "P-Value", 
  p.style = "stars",
  file = here('MEM.figures','ADFA.fh.MEM.html')) # saving .html into figures folder
```

### Segmented Regressions
```{r}
s.m1<-lme(fh~ mpa + year.month + site, random=~1|id, data=mem.data.adfa)
os.m1<-segmented.default(s.m1, ~mpa, npsi=list(mpa=1))
summary.segmented(os.m1)
#AIC: 1479.476

s.m2<-lme(fh~ lfm + year.month + site, random=~1|id, data=mem.data.adfa)
os.m2<-segmented.default(s.m2, ~lfm, npsi=list(lfm=1))
summary.segmented(os.m2)
#AIC: 1490.198

s.m3<-lme(fh~ ww.flam.sample + year.month + site, random=~1|id, data=mem.data.adfa)
os.m3<-segmented.default(s.m3, ~ww.flam.sample, npsi=list(ww.flam.sample=1))
summary.segmented(os.m3)
#AIC: 1487.758

s.m4<-lme(fh~ dw.flam.sample + year.month + site, random=~1|id, data=mem.data.adfa)
os.m4<-segmented.default(s.m4, ~dw.flam.sample, npsi=list(dw.flam.sample=1))
summary.segmented(os.m4)
#AIC: 1495.72
```

## CEME

### Mixed Effects Models
```{r}
m1 <- lme(fh~ mpa + year.month + site, random=~1|id, data=mem.data.ceme)

m2 <- lme(fh~ lfm + year.month + site, random=~1|id, data=mem.data.ceme)

m3 <- lme(fh~ ww.flam.sample + year.month + site, random=~1|id, data=mem.data.ceme)

m4 <- lme(fh~ dw.flam.sample + year.month + site, random=~1|id, data=mem.data.ceme)

m5 <- lme(fh~ mpa + dw.flam.sample + sample.wt + year.month + site, random=~1|id, data=mem.data.ceme)
```

Table
```{r}
tab_model(m1, m2, m3, m4, m5,
          show.reflvl = FALSE, 
          digits = 3, 
          show.aic = TRUE, 
          show.ci = FALSE,
          show.icc = FALSE, 
          pred.labels = c(),
         dv.labels = c("Model 1", "Model 2", "Model 3", "Model 4", "Model 5"),
         string.pred = "Coeffcient", 
         title = "models with no collinearity",
  string.p = "P-Value", 
  p.style = "stars",
  file = here('MEM.figures','CEME.fh.MEM.html')) # saving .html into figures folder
```

### Segmented Regressions
```{r}
s.m1<-lme(fh~ mpa + year.month + site, random=~1|id, data=mem.data.ceme)
os.m1<-segmented.default(s.m1, ~mpa, npsi=list(mpa=1))
summary.segmented(os.m1)
#AIC: 1028.431

s.m2<-lme(fh~ lfm + year.month + site, random=~1|id, data=mem.data.ceme)
os.m2<-segmented.default(s.m2, ~lfm, npsi=list(lfm=1))
summary.segmented(os.m2)
#AIC: 1027.519

s.m3<-lme(fh~ ww.flam.sample + year.month + site, random=~1|id, data=mem.data.ceme)
os.m3<-segmented.default(s.m3, ~ww.flam.sample, npsi=list(ww.flam.sample=1))
summary.segmented(os.m3)
#AIC: 1037.788

# MODEL 4 DOES NOT WORK
```

# 5. GD: Model Comparison
## ADFA

### Mixed Effects Models
```{r}
m1 <- lme(gd~ mpa + year.month + site, random=~1|id, data=mem.data.adfa)

m2 <- lme(gd~ lfm + year.month + site, random=~1|id, data=mem.data.adfa)

m3 <- lme(gd~ ww.flam.sample + year.month + site, random=~1|id, data=mem.data.adfa)

m4 <- lme(gd~ dw.flam.sample + year.month + site, random=~1|id, data=mem.data.adfa)

m5 <- lme(gd~ mpa + dw.flam.sample + sample.wt + year.month + site, random=~1|id, data=mem.data.adfa)
```

Table
```{r}
tab_model(m1, m2, m3, m4, m5,
          show.reflvl = FALSE, 
          digits = 3, 
          show.aic = TRUE, 
          show.ci = FALSE,
          show.icc = FALSE, 
          pred.labels = c(),
         dv.labels = c("Model 1", "Model 2", "Model 3", "Model 4", "Model 5"),
         string.pred = "Coeffcient", 
         title = "models with no collinearity",
  string.p = "P-Value", 
  p.style = "stars",
  file = here('MEM.figures','ADFA.gd.MEM.html')) # saving .html into figures folder
```

### Segmented Regressions
```{r}
s.m1<-lme(gd~ mpa + year.month + site, random=~1|id, data=mem.data.adfa)
os.m1<-segmented.default(s.m1, ~mpa, npsi=list(mpa=1))
summary.segmented(os.m1)
#AIC: 2407.953

s.m2<-lme(gd~ lfm + year.month + site, random=~1|id, data=mem.data.adfa)
os.m2<-segmented.default(s.m2, ~lfm, npsi=list(lfm=1))
summary.segmented(os.m2)
#AIC: 2405.708

s.m3<-lme(gd~ ww.flam.sample + year.month + site, random=~1|id, data=mem.data.adfa)
os.m3<-segmented.default(s.m3, ~ww.flam.sample, npsi=list(ww.flam.sample=1))
summary.segmented(os.m3)
#AIC: 2408.069

s.m4<-lme(gd~ dw.flam.sample + year.month + site, random=~1|id, data=mem.data.adfa)
os.m4<-segmented.default(s.m4, ~dw.flam.sample, npsi=list(dw.flam.sample=1))
summary.segmented(os.m4)
#AIC: 2401.975
```

## CEME

### Mixed Effects Models
```{r}
m1 <- lme(gd~ mpa + year.month + site, random=~1|id, data=mem.data.ceme)

m2 <- lme(gd~ lfm + year.month + site, random=~1|id, data=mem.data.ceme)

m3 <- lme(gd~ ww.flam.sample + year.month + site, random=~1|id, data=mem.data.ceme)

m4 <- lme(gd~ dw.flam.sample + year.month + site, random=~1|id, data=mem.data.ceme)

m5 <- lme(gd~ mpa + dw.flam.sample + sample.wt + year.month + site, random=~1|id, data=mem.data.ceme)
```

Table
```{r}
tab_model(m1, m2, m3, m4, m5,
          show.reflvl = FALSE, 
          digits = 3, 
          show.aic = TRUE, 
          show.ci = FALSE,
          show.icc = FALSE, 
          pred.labels = c(),
         dv.labels = c("Model 1", "Model 2", "Model 3", "Model 4", "Model 5"),
         string.pred = "Coeffcient", 
         title = "models with no collinearity",
  string.p = "P-Value", 
  p.style = "stars",
  file = here('MEM.figures','CEME.gd.MEM.html')) # saving .html into figures folder
```

### Segmented Regressions
```{r}
s.m1<-lme(gd~ mpa + year.month + site, random=~1|id, data=mem.data.ceme)
os.m1<-segmented.default(s.m1, ~mpa, npsi=list(mpa=1))
summary.segmented(os.m1)
#AIC: 1737.204

s.m2<-lme(gd~ lfm + year.month + site, random=~1|id, data=mem.data.ceme)
os.m2<-segmented.default(s.m2, ~lfm, npsi=list(lfm=1))
summary.segmented(os.m2)
#AIC: 1737.134

s.m3<-lme(gd~ ww.flam.sample + year.month + site, random=~1|id, data=mem.data.ceme)
os.m3<-segmented.default(s.m3, ~ww.flam.sample, npsi=list(ww.flam.sample=1))
summary.segmented(os.m3)
#AIC: 1732.315

s.m4<-lme(gd~ dw.flam.sample + year.month + site, random=~1|id, data=mem.data.ceme)
os.m4<-segmented.default(s.m4, ~dw.flam.sample, npsi=list(dw.flam.sample=1))
summary.segmented(os.m4)
#AIC: 1733.556
```

# 6. FD: Model Comparison
## ADFA

### Mixed Effects Models
```{r}
m1 <- lme(fd~ mpa + year.month + site, random=~1|id, data=mem.data.adfa)

m2 <- lme(fd~ lfm + year.month + site, random=~1|id, data=mem.data.adfa)

m3 <- lme(fd~ ww.flam.sample + year.month + site, random=~1|id, data=mem.data.adfa)

m4 <- lme(fd~ dw.flam.sample + year.month + site, random=~1|id, data=mem.data.adfa)

m5 <- lme(fd~ mpa + dw.flam.sample + sample.wt + year.month + site, random=~1|id, data=mem.data.adfa)
```

Table
```{r}
tab_model(m1, m2, m3, m4, m5,
          show.reflvl = FALSE, 
          digits = 3, 
          show.aic = TRUE, 
          show.ci = FALSE,
          show.icc = FALSE, 
          pred.labels = c(),
         dv.labels = c("Model 1", "Model 2", "Model 3", "Model 4", "Model 5"),
         string.pred = "Coeffcient", 
         title = "models with no collinearity",
  string.p = "P-Value", 
  p.style = "stars",
  file = here('MEM.figures','ADFA.fd.MEM.html')) # saving .html into figures folder
```

### Segmented Regressions
```{r}
s.m1<-lme(fd~ mpa + year.month + site, random=~1|id, data=mem.data.adfa)
os.m1<-segmented.default(s.m1, ~mpa, npsi=list(mpa=1))
summary.segmented(os.m1)
#AIC: 1513.617

s.m2<-lme(fd~ lfm + year.month + site, random=~1|id, data=mem.data.adfa)
os.m2<-segmented.default(s.m2, ~lfm, npsi=list(lfm=1))
summary.segmented(os.m2)
#AIC: 1514.792

s.m3<-lme(fd~ ww.flam.sample + year.month + site, random=~1|id, data=mem.data.adfa)
os.m3<-segmented.default(s.m3, ~ww.flam.sample, npsi=list(ww.flam.sample=1))
summary.segmented(os.m3)
#AIC: 1513.072

s.m4<-lme(fd~ dw.flam.sample + year.month + site, random=~1|id, data=mem.data.adfa)
os.m4<-segmented.default(s.m4, ~dw.flam.sample, npsi=list(dw.flam.sample=1))
summary.segmented(os.m4)
#AIC: 1513.666
```

## CEME

### Mixed Effects Models
```{r}
m1 <- lme(fd~ mpa + year.month + site, random=~1|id, data=mem.data.ceme)

m2 <- lme(fd~ lfm + year.month + site, random=~1|id, data=mem.data.ceme)

m3 <- lme(fd~ ww.flam.sample + year.month + site, random=~1|id, data=mem.data.ceme)

m4 <- lme(fd~ dw.flam.sample + year.month + site, random=~1|id, data=mem.data.ceme)

m5 <- lme(fd~ mpa + dw.flam.sample + sample.wt + year.month + site, random=~1|id, data=mem.data.ceme)
```

Table
```{r}
tab_model(m1, m2, m3, m4, m5,
          show.reflvl = FALSE, 
          digits = 3, 
          show.aic = TRUE, 
          show.ci = FALSE,
          show.icc = FALSE, 
          pred.labels = c(),
         dv.labels = c("Model 1", "Model 2", "Model 3", "Model 4", "Model 5"),
         string.pred = "Coeffcient", 
         title = "models with no collinearity",
  string.p = "P-Value", 
  p.style = "stars",
  file = here('MEM.figures','CEME.fd.MEM.html')) # saving .html into figures folder
```

### Segmented Regressions
```{r}
s.m1<-lme(fd~ mpa + year.month + site, random=~1|id, data=mem.data.ceme)
os.m1<-segmented.default(s.m1, ~mpa, npsi=list(mpa=1))
summary.segmented(os.m1)
#AIC: 1053.864

s.m2<-lme(fd~ lfm + year.month + site, random=~1|id, data=mem.data.ceme)
os.m2<-segmented.default(s.m2, ~lfm, npsi=list(lfm=1))
summary.segmented(os.m2)
#AIC: 1052.68

s.m3<-lme(fd~ ww.flam.sample + year.month + site, random=~1|id, data=mem.data.ceme)
os.m3<-segmented.default(s.m3, ~ww.flam.sample, npsi=list(ww.flam.sample=1))
summary.segmented(os.m3)
#AIC: 1054.502

s.m4<-lme(fd~ dw.flam.sample + year.month + site, random=~1|id, data=mem.data.ceme)
os.m4<-segmented.default(s.m4, ~dw.flam.sample, npsi=list(dw.flam.sample=1))
summary.segmented(os.m4)
#AIC: 1052.069
```
